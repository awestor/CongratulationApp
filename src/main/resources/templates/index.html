<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>Календарь Поздравлений</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
<!-- Шапка -->
<header class="main-header">
    <div class="header-container">
        <div class="logo">
            <i class="fas fa-calendar-alt"></i>
            <h1>Календарь Поздравлений</h1>
        </div>
        <nav class="main-nav">
            <a href="/" class="nav-link active">
                <i class="fas fa-home"></i> Главная
            </a>
            <a href="/friends" class="nav-link">
                <i class="fas fa-users"></i> Друзья
            </a>
            <form th:action="@{/logout}" method="post" class="logout-form">
                <button type="submit" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Выйти
                </button>
            </form>
        </nav>
    </div>
</header>

<!-- Сообщение об ошибке -->
<div class="alert alert-error" id="errorAlert" style="display: none;">
    <i class="fas fa-exclamation-triangle"></i>
    <span id="errorMessage">Возникла ошибка, повторите позже</span>
</div>

<main class="main-container">
    <!-- Основной контент -->
    <div class="content-wrapper">
        <!-- Левая часть: Календарь -->
        <div class="calendar-section">
            <div class="calendar-wrapper">
                <div class="calendar-header">
                    <button id="prev-month" class="nav-btn" title="Предыдущий месяц">
                        <i class="fas fa-chevron-left"></i>
                    </button>

                    <div class="current-month">
                        <span id="current-month-year"></span>
                        <div class="today-btn-container">
                            <button id="today-btn" class="today-btn">
                                <i class="fas fa-calendar-day"></i> Сегодня
                            </button>
                        </div>
                    </div>

                    <button id="next-month" class="nav-btn" title="Следующий месяц">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <div class="calendar-weekdays">
                    <div class="weekday">Пн</div>
                    <div class="weekday">Вт</div>
                    <div class="weekday">Ср</div>
                    <div class="weekday">Чт</div>
                    <div class="weekday">Пт</div>
                    <div class="weekday">Сб</div>
                    <div class="weekday">Вс</div>
                </div>

                <div class="calendar-days" id="calendar-days">
                    <!-- Динамически заполняется JavaScript (42 ячейки: 6 строк × 7 дней) -->
                </div>
            </div>

            <!-- Легенда под календарем -->
            <div class="legend-container">
                <h3><i class="fas fa-palette"></i> Легенда цветов</h3>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="color-box not-celebrated"></div>
                        <span>Нет друзей</span>
                    </div>
                    <div class="legend-item">
                        <div class="color-box has-friends"></div>
                        <span>Есть друзья</span>
                    </div>
                    <div class="legend-item">
                        <div class="color-box all-celebrated"></div>
                        <span>Все отмечены</span>
                    </div>
                    <div class="legend-item">
                        <div class="color-box today-special"></div>
                        <span>Сегодня</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Правая часть: Список друзей на выбранную дату -->
        <div class="friends-section">
            <div class="friends-list-container">
                <div class="section-header">
                    <h2 id="selected-date-title">На <span class="date-display"></span> поздравления ожидают:</h2>
                </div>

                <div class="friends-list" id="selected-date-friends">
                    <div class="empty-state">
                        <div class="loading-spinner"></div>
                        <span>Выберите дату</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Список предстоящих дней рождений -->
    <div class="upcoming-birthdays">
        <div class="section-header-with-button">
            <h2>Ближайшие дни рождения</h2>
            <a href="/friends" class="view-all-btn">
                <i class="fas fa-list"></i> Смотреть все
            </a>
        </div>

        <div class="birthdays-table-container">
            <table class="birthdays-table">
                <thead>
                <tr>
                    <th>Имя</th>
                    <th>Дата рождения</th>
                    <th>Дней осталось</th>
                </tr>
                </thead>
                <tbody id="upcoming-birthdays-list">
                <!-- Динамически заполняется JavaScript -->
                <tr class="loading-row">
                    <td colspan="3">
                        <div class="loading-spinner"></div>
                        <span>Загрузка данных...</span>
                    </td>
                </tr>
                </tbody>
            </table>

            <!-- Пагинация -->
            <div class="pagination" id="pagination" style="display: none;">
                <button class="pagination-btn" id="prev-page" disabled>
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="page-numbers" id="page-numbers"></div>
                <button class="pagination-btn" id="next-page">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</main>

<script th:src="@{/js/main.js}"></script>

</body>
</html>